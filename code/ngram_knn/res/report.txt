D:\Anaconda3\envs\malicious-cmd-detection\python.exe F:/work/malicious-cmd-detection/code/ngram_knn/ngrams-knn.py
INFO:root:loading data from file:data/meta_data\dataset_clean_add_linuxde.pkl
1.0
INFO:root:abnormal data item: 4279
INFO:root:normal data item: 18587
INFO:root:loading data finished!
INFO:root:computing distance for normal commands! total: 1000
INFO:root:calculating distance (total item: 1000), started at: 2020-07-27 17:21:08.976612
INFO:root:calculate finished, cost 180 seconds
INFO:root:computing distance for abnormal commands!
INFO:root:calculating distance (total item: 1000), started at: 2020-07-27 17:24:09.544756
INFO:root:calculate finished, cost 115 seconds
INFO:root:computing finished!
INFO:root:test for distance bound in [1, 5]
report for distance bound:0.2
              precision    recall  f1-score   support

           0       1.00      0.57      0.73      1000
           1       0.70      1.00      0.82      1000

    accuracy                           0.79      2000
   macro avg       0.85      0.79      0.78      2000
weighted avg       0.85      0.79      0.78      2000

report for distance bound:0.225
              precision    recall  f1-score   support

           0       1.00      0.58      0.73      1000
           1       0.70      1.00      0.82      1000

    accuracy                           0.79      2000
   macro avg       0.85      0.79      0.78      2000
weighted avg       0.85      0.79      0.78      2000

report for distance bound:0.25
              precision    recall  f1-score   support

           0       1.00      0.65      0.79      1000
           1       0.74      1.00      0.85      1000

    accuracy                           0.82      2000
   macro avg       0.87      0.82      0.82      2000
weighted avg       0.87      0.82      0.82      2000

report for distance bound:0.275
              precision    recall  f1-score   support

           0       1.00      0.65      0.79      1000
           1       0.74      1.00      0.85      1000

    accuracy                           0.82      2000
   macro avg       0.87      0.82      0.82      2000
weighted avg       0.87      0.82      0.82      2000

report for distance bound:0.3
              precision    recall  f1-score   support

           0       1.00      0.70      0.82      1000
           1       0.77      1.00      0.87      1000

    accuracy                           0.85      2000
   macro avg       0.88      0.85      0.85      2000
weighted avg       0.88      0.85      0.85      2000

report for distance bound:0.325
              precision    recall  f1-score   support

           0       1.00      0.70      0.82      1000
           1       0.77      1.00      0.87      1000

    accuracy                           0.85      2000
   macro avg       0.88      0.85      0.85      2000
weighted avg       0.88      0.85      0.85      2000

report for distance bound:0.35
              precision    recall  f1-score   support

           0       0.99      0.93      0.96      1000
           1       0.93      0.99      0.96      1000

    accuracy                           0.96      2000
   macro avg       0.96      0.96      0.96      2000
weighted avg       0.96      0.96      0.96      2000

report for distance bound:0.375
              precision    recall  f1-score   support

           0       0.99      0.93      0.96      1000
           1       0.93      0.99      0.96      1000

    accuracy                           0.96      2000
   macro avg       0.96      0.96      0.96      2000
weighted avg       0.96      0.96      0.96      2000

report for distance bound:0.4
              precision    recall  f1-score   support

           0       0.99      0.93      0.96      1000
           1       0.94      0.99      0.96      1000

    accuracy                           0.96      2000
   macro avg       0.96      0.96      0.96      2000
weighted avg       0.96      0.96      0.96      2000

report for distance bound:0.425
              precision    recall  f1-score   support

           0       0.99      0.93      0.96      1000
           1       0.94      0.99      0.96      1000

    accuracy                           0.96      2000
   macro avg       0.96      0.96      0.96      2000
weighted avg       0.96      0.96      0.96      2000

report for distance bound:0.44999999999999996
              precision    recall  f1-score   support

           0       0.98      0.96      0.97      1000
           1       0.96      0.98      0.97      1000

    accuracy                           0.97      2000
   macro avg       0.97      0.97      0.97      2000
weighted avg       0.97      0.97      0.97      2000

report for distance bound:0.475
              precision    recall  f1-score   support

           0       0.98      0.96      0.97      1000
           1       0.96      0.98      0.97      1000

    accuracy                           0.97      2000
   macro avg       0.97      0.97      0.97      2000
weighted avg       0.97      0.97      0.97      2000

report for distance bound:0.5
              precision    recall  f1-score   support

           0       0.93      0.99      0.96      1000
           1       0.99      0.92      0.96      1000

    accuracy                           0.96      2000
   macro avg       0.96      0.96      0.96      2000
weighted avg       0.96      0.96      0.96      2000

report for distance bound:0.5249999999999999
              precision    recall  f1-score   support

           0       0.93      0.99      0.96      1000
           1       0.99      0.92      0.96      1000

    accuracy                           0.96      2000
   macro avg       0.96      0.96      0.96      2000
weighted avg       0.96      0.96      0.96      2000

report for distance bound:0.55
              precision    recall  f1-score   support

           0       0.93      1.00      0.96      1000
           1       1.00      0.92      0.96      1000

    accuracy                           0.96      2000
   macro avg       0.96      0.96      0.96      2000
weighted avg       0.96      0.96      0.96      2000

report for distance bound:0.575
              precision    recall  f1-score   support

           0       0.92      1.00      0.95      1000
           1       1.00      0.91      0.95      1000

    accuracy                           0.95      2000
   macro avg       0.96      0.95      0.95      2000
weighted avg       0.96      0.95      0.95      2000

report for distance bound:0.6
              precision    recall  f1-score   support

           0       0.84      1.00      0.91      1000
           1       1.00      0.81      0.89      1000

    accuracy                           0.90      2000
   macro avg       0.92      0.90      0.90      2000
weighted avg       0.92      0.90      0.90      2000

report for distance bound:0.625
              precision    recall  f1-score   support

           0       0.84      1.00      0.91      1000
           1       1.00      0.81      0.89      1000

    accuracy                           0.90      2000
   macro avg       0.92      0.90      0.90      2000
weighted avg       0.92      0.90      0.90      2000

report for distance bound:0.6499999999999999
              precision    recall  f1-score   support

           0       0.83      1.00      0.90      1000
           1       0.99      0.79      0.88      1000

    accuracy                           0.90      2000
   macro avg       0.91      0.90      0.89      2000
weighted avg       0.91      0.90      0.89      2000

report for distance bound:0.675
              precision    recall  f1-score   support

           0       0.75      1.00      0.86      1000
           1       0.99      0.67      0.80      1000

    accuracy                           0.83      2000
   macro avg       0.87      0.83      0.83      2000
weighted avg       0.87      0.83      0.83      2000

report for distance bound:0.7
              precision    recall  f1-score   support

           0       0.75      1.00      0.86      1000
           1       1.00      0.67      0.80      1000

    accuracy                           0.83      2000
   macro avg       0.87      0.83      0.83      2000
weighted avg       0.87      0.83      0.83      2000